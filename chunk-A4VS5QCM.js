import{a as Nt}from"./chunk-NUBAC3PU.js";import{g as Ft}from"./chunk-5RVYUHMO.js";import"./chunk-JOGSQ4WO.js";import{a as Y}from"./chunk-XH2CKAIK.js";import{b as Tt}from"./chunk-BULE72JU.js";import{a as b,h as it}from"./chunk-I35Y2QOD.js";import"./chunk-FZVJKCT4.js";import{a as kt}from"./chunk-2UUWE3MU.js";import{$a as ut,Ac as vt,Bb as dt,Be as _t,Bf as K,Ce as U,De as q,Df as Ot,Ee as z,Fb as f,G as S,Gb as g,Hb as ct,Ia as _,Ja as x,L as rt,La as mt,Le as W,Ma as pt,Mb as ft,Me as H,Na as lt,Nb as P,O as at,Oa as c,Pa as o,Pb as gt,Pf as It,Qa as r,Qb as y,Qd as bt,Ra as l,S as st,W as p,Wd as Ct,_a as h,a as et,ae as St,be as B,ca as d,cf as xt,df as wt,ee as Et,ef as Pt,gf as yt,ie as R,ke as V,lb as w,ld as I,mb as s,md as k,me as A,nb as u,ne as G,ng as Q,ob as D,od as Mt,pa as m,pg as X,rc as ht,rd as T,re as $,sd as N,ta as E,ue as j,xa as M,xc as O,xd as Dt,xe as L,y as ot,yf as J,zd as F}from"./chunk-SYGYQDC7.js";var Bt=[{name:"\u05E4\u05E8\u05D5\u05E4\u05D9\u05DC",children:[{name:"\u05D4\u05E4\u05E8\u05D5\u05E4\u05D9\u05DC \u05E9\u05DC\u05D9",route:"/profile/me"},{name:"\u05E9\u05D9\u05E0\u05D5\u05D9 \u05E1\u05D9\u05E1\u05DE\u05D4",route:"/profile/pwd"}]}];function Gt(a,e){a&1&&l(0,"mat-spinner",1)}function $t(a,e){if(a&1&&s(0),a&2){let C=ut();D(" ",C.caption()," ")}}var Rt=(()=>{let e=class e{constructor(){this.caption=y("\u05E9\u05DE\u05D9\u05E8\u05D4"),this.isvalid=y.required(),this.loading=y(!1),this.onSave=gt()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=M({type:e,selectors:[["button-save"]],inputs:{caption:[1,"caption"],isvalid:[1,"isvalid"],loading:[1,"loading"]},outputs:{onSave:"onSave"},decls:3,vars:2,consts:[["mat-flat-button","","color","primary",3,"click","disabled"],["diameter","20"]],template:function(i,t){i&1&&(o(0,"button",0),h("click",function(){return t.onSave.emit()}),_(1,Gt,1,0,"mat-spinner",1)(2,$t,1,1),r()),i&2&&(c("disabled",!t.isvalid()||t.loading()),m(),x(t.loading()?1:2))},dependencies:[Dt,bt],styles:["[_nghost-%COMP%]{display:contents}button[_ngcontent-%COMP%]{margin-right:8px}"]});let a=e;return a})();var v=`${kt.apiUrl}/profile`,Z=(()=>{let e=class e{constructor(){this.http=p(ht),this.auth=p(Y),this.ruSure=b.ruSure,this.dialog=p(Ct)}get(){return this.http.get(`${v}`).pipe(at(n=>this.auth.profileSet(n)))}save(n){return this.http.post(v,n)}setPwd(n){return this.http.post(v+"/set-pwd",JSON.stringify(n))}getUsers(){return this.http.get(`${v}/users`)}getUser(n){return this.http.get(`${v}/user/${n}`)}saveUser(n){return this.http.post(`${v}/users`,n)}deleteUser(n,i){this.dialog.open(Ot,{data:{title:"\u05D0\u05D9\u05E9\u05D5\u05E8 \u05E4\u05E2\u05D5\u05DC\u05D4"}}).afterClosed().pipe(ot(t=>!!t),rt(()=>this.http.delete(`${v}/${n}`))).subscribe(i)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=st({token:e,factory:e.\u0275fac,providedIn:"root"});let a=e;return a})();function qt(a,e){if(a&1&&(o(0,"mat-button-toggle",13),s(1),r()),a&2){let C=e.$implicit;c("value",C.id),m(),u(C.name)}}var Vt=(()=>{let e=class e{constructor(n){this.service=p(Z),this.auth=p(Y),this.snackbar=p(K),this.responsive=p(J),this.isDesktop=this.responsive.isDesktop,this.route=p(O),this.pageTitle=this.route.snapshot.title||"",this.item=d(void 0),this.error=d(void 0),this.submitted=d(!1),this.genders=[{id:it.Male,name:b.genders.male},{id:it.Female,name:b.genders.female}],this.saving=d(!1),P(()=>{this.error()&&this.snackbar.error({title:"\u05E9\u05D2\u05D9\u05D0\u05D4",msg:this.error(),btn:"\u05E1\u05D2\u05D5\u05E8",duration:1e4})});let i=V;this.f=n.group({fname:[,[i.required,i.minLength(2)]],lname:[,[i.required,i.minLength(2)]],m:[,[i.pattern(/^0?5[\d]{8}$/)]],e:[,[i.email]],gender:[,[i.required]]}),this.c=this.f.controls,Et([this.item],([t])=>{t&&(this.f.reset(t),t.m&&this.c.m.setValue("0"+t.m))})}ngOnInit(){this.item.set(this.auth.profile())}save(){if(this.submitted.set(!0),this.saving()==!0||!this.f.valid)return;this.saving.set(!0);let n=et(et({},this.item()),this.f.value);n.e?.length||(n.e=void 0),this.service.save(n).pipe(S(()=>this.saving.set(!1))).subscribe({next:()=>{this.snackbar.success({msg:"\u05D4\u05DE\u05D9\u05D3\u05E2 \u05E0\u05E9\u05DE\u05E8 \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4",duration:3e3}),this.service.get().subscribe(i=>this.auth.profileSet(i))},error:i=>this.error.set(i)})}};e.\u0275fac=function(i){return new(i||e)(E(U))},e.\u0275cmp=M({type:e,selectors:[["ng-component"]],decls:44,vars:24,consts:[[1,"profile"],["novalidate","",1,"flex","column","items-start","xl",3,"ngSubmit","formGroup"],["appearance","outline"],["for","fname"],["matInput","","formControlName","fname","cdkFocusInitial",""],["for","lname"],["matInput","","formControlName","lname"],["for","mobile"],["matInput","","formControlName","m","type","tel"],["matInput","","formControlName","e","type","email",1,"ltr"],[1,"gender"],[1,"caption"],["formControlName","gender"],[3,"value"],[1,"action-buttons"],[3,"caption","isvalid","loading"]],template:function(i,t){i&1&&(o(0,"div",0)(1,"h3"),s(2),r(),o(3,"form",1),h("ngSubmit",function(){return t.save()}),o(4,"mat-form-field",2)(5,"mat-label",3),s(6," \u05E9\u05DD \u05E4\u05E8\u05D8\u05D9"),r(),l(7,"input",4),o(8,"mat-error"),s(9),f(10,"validate"),r()(),o(11,"mat-form-field",2)(12,"mat-label",5),s(13," \u05E9\u05DD \u05DE\u05E9\u05E4\u05D7\u05D4"),r(),l(14,"input",6),o(15,"mat-error"),s(16),f(17,"validate"),r()(),o(18,"mat-form-field",2)(19,"mat-label",7),s(20," \u05D8\u05DC\u05E4\u05D5\u05DF \u05E0\u05D9\u05D9\u05D3"),r(),l(21,"input",8),o(22,"mat-error"),s(23),f(24,"validate"),r()(),o(25,"mat-form-field",2)(26,"mat-label"),s(27,' \u05D3\u05D5\u05D0"\u05DC '),r(),l(28,"input",9),o(29,"mat-error"),s(30),f(31,"validate"),r()(),o(32,"div",10)(33,"label",11),s(34,"\u05DE\u05D2\u05D3\u05E8"),r(),o(35,"mat-button-toggle-group",12),pt(36,qt,2,2,"mat-button-toggle",13,mt),r(),o(38,"mat-error"),s(39),f(40,"validate"),r()(),o(41,"div",14),l(42,"button-save",15),f(43,"trans"),r()()()),i&2&&(w(t.isDesktop()?"desktop":"mobile"),m(2),u(t.pageTitle),m(),c("formGroup",t.f),m(6),u(g(10,12,t.c.fname.errors)),m(7),u(g(17,14,t.c.lname.errors)),m(7),u(g(24,16,t.c.m.errors)),m(7),u(g(31,18,t.c.e.errors)),m(6),lt(t.genders),m(3),u(g(40,20,t.c.gender.errors)),m(3),c("caption",g(43,22,"btns.save"))("isvalid",t.f.valid)("loading",t.saving()))},dependencies:[q,$,R,A,G,z,j,L,N,T,I,k,H,W,F,B,yt,Pt,xt,wt,Rt,Q,X],styles:["[_nghost-%COMP%]{display:contents}.profile[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:1.5rem;width:100%}.profile.desktop[_ngcontent-%COMP%]{min-width:320px;max-width:420px;margin:0 auto}.profile[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%}.profile[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.gender[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem;margin-top:-4px}.gender[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{font-size:12px;margin-right:1.25rem}.gender[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{min-width:100px}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-top:1rem;border-top:1px solid #afafaf;width:100%}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-right:1rem}"]});let a=e;return a})();var zt=()=>({pattern:"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05D0\u05D9\u05E0\u05D4 \u05D7\u05D6\u05E7\u05D4 \u05DE\u05E1\u05E4\u05D9\u05E7"});function Wt(a,e){a&1&&(o(0,"div"),s(1," \u05E4\u05D2 \u05EA\u05D5\u05E7\u05E3 \u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05E9\u05DC\u05DA \u05DC\u05DE\u05E2\u05E8\u05DB\u05EA. \u05D9\u05E9 \u05DC\u05D4\u05D2\u05D3\u05D9\u05E8 \u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D3\u05E9\u05D4. "),r())}var At=(()=>{let e=class e{constructor(n){this.service=p(Z),this.router=p(vt),this.snackbar=p(K),this.responsive=p(J),this.isDesktop=this.responsive.isDesktop,this.route=p(O),this.pageTitle=this.route.snapshot.title||"",this.pwdSettings=p(Tt).tenant()?.settings?.pwdSettings,this.showWeakText=this.route.snapshot.queryParams.weak=="true",this.error=d(void 0),this.pwdOpen=d(!1),this.pwdType=ft(()=>this.pwdOpen()?"text":"password"),this.submitted=d(!1),this.saving=d(!1),P(()=>{this.error()&&this.snackbar.error({title:"\u05E9\u05D2\u05D9\u05D0\u05D4",msg:this.error(),btn:"\u05E1\u05D2\u05D5\u05E8",duration:1e4})});let i=V;this.f=n.group({pwd:[,[i.required,i.pattern(this.pwdSettings.pattern)]]}),this.c=this.f.controls}save(){this.submitted.set(!0),!(this.saving()==!0||!this.f.valid)&&(this.saving.set(!0),this.service.setPwd(this.c.pwd.value).pipe(S(()=>this.saving.set(!1))).subscribe({next:()=>{this.snackbar.success({msg:"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05E9\u05D5\u05E0\u05EA\u05D4 \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4",duration:3e3}),this.router.navigate(["../"],{relativeTo:this.route})},error:n=>this.error.set(n)}))}};e.\u0275fac=function(i){return new(i||e)(E(U))},e.\u0275cmp=M({type:e,selectors:[["ng-component"]],decls:21,vars:18,consts:[[1,"profile"],["novalidate","",1,"flex","column","items-start","xl",3,"ngSubmit","formGroup"],["appearance","outline"],["matInput","","formControlName","pwd","autocomplete","new-password","maxlength","18",1,"ltrr",3,"type"],["matSuffix","",3,"click"],[1,"flex","text-secondary"],[1,"action-buttons"],[3,"caption","isvalid","loading"]],template:function(i,t){i&1&&(o(0,"div",0)(1,"h3"),s(2),r(),o(3,"form",1),h("ngSubmit",function(){return t.save()}),_(4,Wt,2,0,"div"),o(5,"mat-form-field",2)(6,"mat-label"),s(7,"\u05E1\u05D9\u05E1\u05DE\u05D4"),r(),l(8,"input",3),o(9,"mat-icon",4),h("click",function(){return t.pwdOpen.set(!t.pwdOpen())}),s(10),r(),o(11,"mat-error"),s(12),f(13,"validate"),r()(),o(14,"div",5)(15,"mat-icon"),s(16,"info"),r(),s(17),r(),o(18,"div",6),l(19,"button-save",7),f(20,"trans"),r()()()),i&2&&(w(t.isDesktop()?"desktop":"mobile"),m(2),u(t.pageTitle),m(),c("formGroup",t.f),m(),x(t.showWeakText?4:-1),m(4),c("type",t.pwdOpen()?"text":"password"),m(2),D(" ",t.pwdOpen()?"visibility_off":"visibility"," "),m(2),u(ct(13,12,t.c.pwd.errors,dt(17,zt))),m(5),D(" ",t.pwdSettings==null?null:t.pwdSettings.text," "),m(2),c("caption",g(20,15,"btns.save"))("isvalid",t.f.valid)("loading",t.saving()))},dependencies:[q,$,R,A,G,_t,z,j,L,N,T,I,k,Mt,H,W,F,B,St,It,Q,X],styles:["[_nghost-%COMP%]{display:contents}.profile[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:1.5rem;width:100%}.profile.desktop[_ngcontent-%COMP%]{min-width:320px;max-width:420px;margin:0 auto}.profile[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%}.profile[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-top:1rem;border-top:1px solid #afafaf;width:100%}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-right:1rem}"]});let a=e;return a})();var Ke=[{path:"",component:Ft,data:{nav:Bt},children:[{path:"",redirectTo:"me",pathMatch:"full"},{path:"me",title:"\u05D4\u05E4\u05E8\u05D5\u05E4\u05D9\u05DC \u05E9\u05DC\u05D9",component:Vt},{path:"pwd",title:"\u05E9\u05D9\u05E0\u05D5\u05D9 \u05E1\u05D9\u05E1\u05DE\u05D4",component:At},{path:"**",component:Nt,data:{back:"/profile"}}]}];export{Ke as PROFILE_ROUTES};
