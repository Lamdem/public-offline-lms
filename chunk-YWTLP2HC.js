import{a}from"./chunk-XH2CKAIK.js";import{n as d}from"./chunk-I35Y2QOD.js";import{a as p}from"./chunk-FZVJKCT4.js";import{a as s}from"./chunk-2UUWE3MU.js";import{Ac as l,W as o,zc as c}from"./chunk-SYGYQDC7.js";function v(t=!1,...n){return i=>{let e=o(l),r=o(a);if(!r.isLoggedin()){let u=i.url.join("/"),h=e.parseUrl(s.notAuthorizedPath);return new c(h,{state:{needsLogin:!0,afterLoginRedirect:u}})}return n.length&&!n.includes(r.profile().auth)?(t||e.navigate(["/403"],{skipLocationChange:!0}),!1):!0}}function T(){return t=>{let n=o(l),i=o(a);if(!i.isLoggedin()){let e=t.url.join("/"),r=n.parseUrl(s.notAuthorizedPath);return new c(r,{state:{needsLogin:!0,afterLoginRedirect:e}})}return i.profile().auth>p.Account||i.profile()?.schools?.filter(e=>e.role==d.Principal)?.length?!0:(n.navigate(["/403"],{skipLocationChange:!0}),!1)}}function U(t){return(n,i)=>{let e=o(a),r=o(l);if(!e.isLoggedin()){console.error("[matchLmsAuth] Viewer is not logged in");let u=r.parseUrl(s.notAuthorizedPath);return new c(u,{state:{needsLogin:!0,afterLoginRedirect:s.notAuthorizedPath}})}return!(t&&!(t&e.profile().auth))}}function x(t,n=!1){return(i,e)=>{let r=o(a),u=o(l);if(!r.isLoggedin()){console.error("[matchLmsSchoolRole] Viewer is not logged in");let g=u.parseUrl(s.notAuthorizedPath);return new c(g,{state:{needsLogin:!0,afterLoginRedirect:s.notAuthorizedPath}})}if(r.profile().auth>p.Account)return!0;if(n)debugger;let h=e[1].path;if(t==null&&["lms","schools"].includes(h)&&r.profile()?.schools?.length)return!0;let f=+h;if(isNaN(f))return console.error("[matchLmsSchoolRole] Path school is NaN"),!1;let L=r.profile()?.schools?.find(g=>g.id===f);if(!L)return console.error(`[matchLmsSchoolRole] Viewer has no access to school ${f}`),!1;if(t==null)return!0;let m=L?.role;return m?t?m>=d.Student:m===d.Teacher:(console.error(`[matchLmsSchoolRole] Viewer has no role in school ${f}`),!1)}}export{v as a,T as b,U as c,x as d};
