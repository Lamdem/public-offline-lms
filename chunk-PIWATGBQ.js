import{a as ne}from"./chunk-KTQJCX7R.js";import"./chunk-2UUWE3MU.js";import{$a as u,$d as O,Ac as w,Bf as te,G as U,Ia as _,Ja as f,Je as Z,Ma as L,Mb as v,Na as Q,Nb as B,Oa as E,Pa as s,Qa as c,Ra as N,Rd as j,Ud as z,Vd as G,W as p,Wd as X,X as g,Y as h,Ya as D,Yd as Y,Zd as H,_a as C,_d as J,a as A,ae as K,ag as S,be as W,ca as m,ee as y,ic as R,kb as b,lb as F,mb as d,n as T,nb as x,ob as I,pa as l,pb as V,sf as ee,xa as M,xc as $,xd as k,z as q,zd as P}from"./chunk-SYGYQDC7.js";function se(t,a){if(t&1&&(s(0,"div",2)(1,"span",3),d(2,"\u05DE\u05E9\u05DA \u05D6\u05DE\u05DF:"),c(),s(3,"span",4),d(4),c()()),t&2){let o=u();l(4),x(o.formatDuration(o.data.duration))}}var ie=(()=>{let a=class a{constructor(){this.data=p(G),this.router=p(w),this.dialogRef=p(z)}formatDuration(e){let n=Math.floor(e/60),i=e%60;return`${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}goBack(){this.router.navigate([this.data.url]),this.dialogRef.close()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["ng-component"]],decls:13,vars:2,consts:[["mat-dialog-title",""],[1,"results"],[1,"result-item"],[1,"label"],[1,"value"],["align","end"],["mat-flat-button","","color","primary",3,"click"]],template:function(n,i){n&1&&(s(0,"h2",0),d(1,"\u05E1\u05D9\u05D9\u05DE\u05EA \u05D0\u05EA \u05D4\u05DE\u05D1\u05D7\u05DF!"),c(),s(2,"mat-dialog-content")(3,"div",1)(4,"div",2)(5,"span",3),d(6,"\u05E6\u05D9\u05D5\u05DF:"),c(),s(7,"span",4),d(8),c()(),_(9,se,5,1,"div",2),c()(),s(10,"mat-dialog-actions",5)(11,"button",6),C("click",function(){return i.goBack()}),d(12," \u05D7\u05D6\u05E8\u05D4 \u05DC\u05E2\u05DE\u05D5\u05D3 \u05D4\u05E7\u05D5\u05D3\u05DD "),c()()),n&2&&(l(8),x(i.data.score),l(),f(i.data.duration>0?9:-1))},dependencies:[O,Y,J,H,P,k],styles:[".results[_ngcontent-%COMP%]{padding:1rem}.results[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.results[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;min-width:80px}.results[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.2em}"]});let t=a;return t})();var le=(t,a)=>a.t;function de(t,a){if(t&1&&(s(0,"div",3),d(1),c()),t&2){let o=u(2);l(),I("\u05D6\u05DE\u05DF \u05E0\u05D5\u05EA\u05E8: ",o.timeLeft()," \u05E9\u05E0\u05D9\u05D5\u05EA")}}function ue(t,a){if(t&1&&(s(0,"p"),d(1),c()),t&2){let o=u();l(),x(o.desc)}}function me(t,a){t&1&&d(0," check_box ")}function _e(t,a){t&1&&d(0," check_box_outline_blank ")}function fe(t,a){if(t&1){let o=D();s(0,"div",12),C("click",function(){let n=g(o).$implicit,i=u(3);return h(i.toggleAnswer(n))}),s(1,"div",13)(2,"mat-icon",14),_(3,me,1,0)(4,_e,1,0),c(),s(5,"span",15),d(6),c()()()}if(t&2){let o=a.$implicit,e=u(),n=u(),i=u();b("checked",i.checked())("with-feedback",!!e.feedback)("selected",i.selected().includes(o.t))("correct",i.checked()&&o.v)("incorrect",i.checked()&&!o.v&&o.selected)("disabled",(i.submitting()||i.checked())&&!o.selected&&!o.v),l(),b("ltr",n.isLtr),l(2),f(o.selected?3:4),l(3),x(o.t)}}function pe(t,a){t&1&&(s(0,"span"),d(1,"\u05EA\u05E9\u05D5\u05D1\u05D4 \u05E0\u05DB\u05D5\u05E0\u05D4!"),c())}function xe(t,a){t&1&&(s(0,"span"),d(1,"\u05EA\u05E9\u05D5\u05D1\u05D4 \u05D7\u05DC\u05E7\u05D9\u05EA"),c())}function Ce(t,a){t&1&&(s(0,"span"),d(1,"\u05EA\u05E9\u05D5\u05D1\u05D4 \u05E9\u05D2\u05D5\u05D9\u05D4"),c())}function ge(t,a){if(t&1&&(s(0,"div",16)(1,"div",17)(2,"mat-icon"),d(3),c(),_(4,pe,2,0,"span")(5,xe,2,0,"span")(6,Ce,2,0,"span"),c()()),t&2){let o,e=u();F(e.correctTypeID==5?"correct":"incorrect"),l(3),x(e.correctTypeID==5?"check_circle":"cancel"),l(),f((o=e.correctTypeID)===5?4:o===3?5:6)}}function he(t,a){if(t&1&&(s(0,"div",4)(1,"h3"),d(2),c(),_(3,ue,2,1,"p"),s(4,"div",9),L(5,fe,7,16,"div",10,le),c(),_(7,ge,7,4,"div",11),c()),t&2){let o=a,e=u(),n=u();l(),b("ltr",e.isLtr),l(),x(o.q),l(),f(o.desc?3:-1),l(2),Q(o.answers),l(2),f(n.checked()&&o.feedback?7:-1)}}function De(t,a){if(t&1){let o=D();s(0,"button",18),C("click",function(){g(o);let n=u(2);return h(n.prevQuestion())}),s(1,"mat-icon"),d(2,"arrow_forward"),c(),d(3," \u05E9\u05D0\u05DC\u05D4 \u05E7\u05D5\u05D3\u05DE\u05EA "),c(),N(4,"div",19)}if(t&2){let o=u(2);E("disabled",o.currIndex()===0)}}function Me(t,a){if(t&1){let o=D();s(0,"button",8),C("click",function(){g(o);let n=u(2);return h(n.checkAnswer())}),d(1," \u05D1\u05D3\u05D5\u05E7 \u05EA\u05E9\u05D5\u05D1\u05D4 "),c()}if(t&2){let o=u(2);E("disabled",!o.canCheck())}}function Ee(t,a){if(t&1){let o=D();s(0,"div",0)(1,"div",1)(2,"div",2),d(3),c(),_(4,de,2,1,"div",3),c(),_(5,he,8,5,"div",4),s(6,"div",5),_(7,De,5,1),s(8,"div",6),_(9,Me,2,1,"button",7),s(10,"button",8),C("click",function(){g(o);let n=u();return h(n.nextQuestion())}),d(11),c()()()()}if(t&2){let o,e,n,i=a,r=u();l(3),V("\u05E9\u05D0\u05DC\u05D4 ",r.currIndex()+1," \u05DE\u05EA\u05D5\u05DA ",i.qs.length),l(),f(r.timeLeft()!==null&&!((o=r.currQ())!=null&&o.id)?4:-1),l(),f((e=r.currQ())?5:-1,e),l(2),f(i.canReturn?7:-1),l(2),f(!r.checked()&&((n=r.currQ())==null?null:n.feedback)!==0?9:-1),l(),E("disabled",!r.canProceed()),l(),I(" ",r.isLast()?"\u05E1\u05D9\u05D5\u05DD \u05DE\u05D1\u05D7\u05DF":"\u05E9\u05D0\u05DC\u05D4 \u05D4\u05D1\u05D0\u05D4"," ")}}var oe=(()=>{let a=class a{constructor(){this.service=p(ne),this.snackbar=p(te),this.route=p($),this.router=p(w),this.dialog=p(X),this.session=m(null),this.refresh=m(1),this.exam=m(null),this.checked=m(!1),this.timeLeft=m(null),this.error=m(void 0),this.currIndex=m(0),this.currQ=m(void 0),this.currAs=m([]),this.selected=m([]),this.isLast=m(!1),this.correctAnswers=v(()=>this.currAs().filter(e=>!!e.v).map(e=>e.t)),this.canCheck=v(()=>!this.checked()&&!this.submitting()&&this.selected().length>0),this.canProceed=v(()=>!this.submitting()&&(this.checked()||this.currQ()?.feedback===S.None)),this.submitting=m(!1),B(()=>{this.error()?.length&&this.snackbar.error({title:"\u05E9\u05D2\u05D9\u05D0\u05D4",msg:this.error(),btn:"\u05E1\u05D2\u05D5\u05E8",duration:1e4})}),y([this.exam,this.currIndex],([e,n])=>{if(!e)return;let i=e.qs[this.currIndex()];this.checked.set(!!i.id),this.currQ.set(i),this.currAs.set(i.answers),this.selected.set(i.answers.filter(r=>r.selected).map(r=>r.t)),this.isLast.set(n==e.qs.length-1),this.timer&&clearInterval(this.timer),i?.examQID&&(i.time=i.time||e.defaultTime||void 0,i.time?(this.timeLeft.set(i.time),this.timer=setInterval(()=>{let r=this.timeLeft();r!==null&&(r<=0?this.checkAnswer():this.timeLeft.set(r-1))},1e3)):this.timeLeft.set(null))}),y([this.session,this.refresh],([e,n])=>{e&&this.service.getExamBySession(e).pipe(q(i=>{this.error.set(i);let r=this.route.snapshot.queryParams.returnUrl||"/";return this.router.navigate([r]),T})).subscribe(i=>{let r=i.qs.findIndex(re=>!re.id);if(i.statusID==5||r<0){this.exam.set(i),this.finishDialog();return}r>=0&&this.currIndex.set(r),this.exam.set(i)})}),this.session.set(this.route.snapshot.params.session)}checkAnswer(){let e=this.currQ();!e||this.submitting()||(this.submitting.set(!0),this.timer&&(clearInterval(this.timer),e.duration=(e.time||this.exam()?.defaultTime||0)-this.timeLeft()),this.service.answer(this.session(),this.currQ()).pipe(U(()=>this.submitting.set(!1))).subscribe(n=>{this.checked.set(!0),this.currQ.set(n);let i=A({},this.exam());if(i.qs.splice(this.currIndex(),1,n),this.exam.set(i),this.currAs.set(n.answers),!e.feedback){this.nextQuestion();return}if(e.feedback!==S.Simple&&e.feedback===S.Full){for(let r of n.answers)r.v&&r.selected?r.answeredCorrectly=!0:!r.v&&!r.selected&&(r.answeredCorrectly=null);this.currAs.set(n.answers)}}))}toggleAnswer(e){this.submitting()||this.checked()||(e.selected=!e.selected,this.selected.set(this.currAs().filter(n=>n.selected).map(n=>n.t)))}nextQuestion(){this.exam()&&(this.isLast()?this.refresh.set(this.refresh()+1):this.currIndex.set(this.currIndex()+1))}prevQuestion(){let e=this.exam();!e||!e.canReturn||this.currIndex()>0&&this.currIndex.set(this.currIndex()-1)}finishDialog(){let e=this.exam();if(!e)return;let n={score:e.finalScore||0,duration:e.totalDuration||0,url:this.route.snapshot.queryParams.returnUrl||"/"};this.dialog.open(ie,{data:n,disableClose:!0})}ngOnDestroy(){this.timer&&clearInterval(this.timer)}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["ng-component"]],decls:1,vars:1,consts:[[1,"exam-container"],[1,"exam-header"],[1,"progress"],[1,"timer"],[1,"question-container"],[1,"exam-footer"],[1,"action-buttons"],["mat-flat-button","","color","primary",3,"disabled"],["mat-flat-button","","color","primary",3,"click","disabled"],[1,"answers"],[1,"answer-item",3,"checked","with-feedback","selected","correct","incorrect","disabled"],[1,"feedback",3,"class"],[1,"answer-item",3,"click"],[1,"answer-content"],[1,"status-icon"],[1,"answer-text"],[1,"feedback"],[1,"flex"],["mat-button","",3,"click","disabled"],[1,"spacer"]],template:function(n,i){if(n&1&&_(0,Ee,12,8,"div",0),n&2){let r;f((r=i.exam())?0:-1,r)}},dependencies:[R,P,k,W,K,j,Z,ee,O],styles:[".exam-container[_ngcontent-%COMP%]{padding:2rem;max-width:800px;margin:0 auto}.exam-container[_ngcontent-%COMP%]   .exam-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:2rem}.question-container[_ngcontent-%COMP%]{margin-bottom:2rem}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin:1rem 0}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item[_ngcontent-%COMP%]{cursor:pointer;padding:.75rem;border:1px solid #ddd;border-radius:4px;transition:all .2s ease}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item[_ngcontent-%COMP%]:hover:not(.correct):not(.incorrect){background-color:#f5f5f5}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item.checked[_ngcontent-%COMP%]{cursor:default}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item.with-feedback.selected[_ngcontent-%COMP%]:not(.checked){background-color:#e3f2fd;border-color:#2196f3}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item.with-feedback.correct[_ngcontent-%COMP%]{background-color:#c8e6c9;border-color:#4caf50}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item.with-feedback.incorrect[_ngcontent-%COMP%]{background-color:#ffcdd2;border-color:#f44336}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item[_ngcontent-%COMP%]   .answer-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item[_ngcontent-%COMP%]   .answer-content[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{color:inherit;opacity:.7}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item[_ngcontent-%COMP%]   .answer-content[_ngcontent-%COMP%]   .answer-text[_ngcontent-%COMP%]{flex:1}.question-container[_ngcontent-%COMP%]   .answers[_ngcontent-%COMP%]   .answer-item[disabled][_ngcontent-%COMP%]{opacity:.7;cursor:not-allowed}.exam-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.feedback[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;margin-top:1rem;padding:1rem;border-radius:4px}.feedback.correct[_ngcontent-%COMP%]{background-color:#c8e6c9;color:#2e7d32}.feedback.incorrect[_ngcontent-%COMP%]{background-color:#ffcdd2;color:#c62828}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:1rem}"]});let t=a;return t})();var He=[{path:":session",component:oe}];export{He as EXAM_ROUTES};
