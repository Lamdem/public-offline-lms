import{a as pe,b as ce}from"./chunk-ZQTISU5S.js";import{a as de}from"./chunk-XH2CKAIK.js";import{b as fe}from"./chunk-B42N3DRY.js";import"./chunk-FZVJKCT4.js";import{a as se}from"./chunk-2UUWE3MU.js";import{Ac as I,Bc as P,Bf as oe,Ce as J,Cf as ae,De as Q,Ee as W,Fb as h,Ff as ue,Gb as E,Ia as c,Ja as f,Le as X,Me as Z,Nb as x,Oa as s,Pa as n,Qa as t,Ra as p,W as l,_a as D,a as v,ae as R,b as M,be as U,ca as d,ic as A,ie as j,if as $,jf as ee,kb as _,ke as q,ld as k,lf as te,mb as o,md as N,me as G,n as C,nb as y,ne as K,nf as ie,ng as me,ob as g,od as F,pa as r,pg as le,rd as T,re as Y,sd as B,sf as ne,ta as w,ue as z,xa as S,xc as O,xd as L,xe as H,yf as re,z as b,zd as V}from"./chunk-SYGYQDC7.js";function De(a,m){a&1&&(n(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function he(a,m){a&1&&(n(0,"mat-error"),o(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05D0\u05D9\u05E0\u05D4 \u05D7\u05D6\u05E7\u05D4 \u05DE\u05E1\u05E4\u05D9\u05E7"),t())}function Ee(a,m){a&1&&(n(0,"span"),o(1,"\u05D4\u05E4\u05E2\u05DC \u05D0\u05EA \u05D4\u05DE\u05E9\u05EA\u05DE\u05E9 \u05E9\u05DC\u05D9"),t())}function ve(a,m){a&1&&p(0,"shared-loading")}var Ke=(()=>{let m=class m{constructor(u){this.service=l(de),this.tenant=l(fe),this.route=l(O),this.router=l(I),this.snackbar=l(oe),this.responsive=l(re),this.isMobile=this.responsive.isMobile,this.pwdSettings=this.tenant.tenant()?.settings?.pwdSettings,this.loading=d(!1),this.saving=d(!1),this.error=d(null),this.pwdOpen=d(!1),this.captchaKey=se.captchaKey,this.service.isLoggedin()&&this.router.navigate(["/"]),x(()=>{this.error()?.length&&this.snackbar.error({title:"\u05E9\u05D2\u05D9\u05D0\u05D4",msg:this.error(),btn:"\u05E1\u05D2\u05D5\u05E8",duration:7e3})});let i=q;this.f=u.group({identifier:[,[i.required,i.minLength(5)]],pwd:[,[i.required,i.pattern(this.pwdSettings.pattern)]],remember:[!0]}),this.c=this.f.controls}ngOnInit(){var u=sessionStorage.getItem("identifier");u?.length&&u!="undefined"&&this.c.identifier.setValue(u)}resolved(u){this.c.captcha.setValue(u)}onSubmit(){if(this.saving()||this.f.invalid)return;this.saving.set(!0);let u=M(v({},this.f.value),{comment:"site"});this.service.activateUser(u).pipe(b(i=>(this.saving.set(!1),this.error.set(i||i.msg),C))).subscribe({next:()=>{let i=this.service.returnUrl||this.route.snapshot.queryParams.returnUrl||"/";this.router.navigateByUrl(i)}})}};m.\u0275fac=function(i){return new(i||m)(w(J))},m.\u0275cmp=S({type:m,selectors:[["ng-component"]],decls:34,vars:18,consts:[["appearance","outlined"],["novalidate","",3,"ngSubmit","formGroup"],["appearance","outline"],["matInput","","formControlName","identifier","autocomplete","username","cdkFocus","","placeholder","\u05E1\u05E4\u05E8\u05D5\u05EA \u05D1\u05DC\u05D1\u05D3",3,"type"],["for","pwd"],["matInput","","id","pwd","formControlName","pwd","autocomplete","new-password","placeholder","\u05E1\u05D9\u05E1\u05DE\u05D4",1,"ltrr",3,"type"],["matSuffix","",3,"click"],[1,"flex","text-secondary"],["formControlName","remember"],["mat-flat-button","","color","primary","type","submit",1,"w-100",3,"disabled"],[3,"err"],["routerLink","/auth/login"]],template:function(i,e){i&1&&(n(0,"mat-card",0)(1,"mat-card-title"),o(2,"\u05D4\u05E4\u05E2\u05DC\u05EA \u05DE\u05E9\u05EA\u05DE\u05E9 \u05D1\u05D9\u05EA \u05E1\u05E4\u05E8\u05D9"),t(),n(3,"form",1),D("ngSubmit",function(){return e.onSubmit()}),n(4,"mat-card-content")(5,"mat-form-field",2)(6,"mat-label"),o(7),h(8,"trans"),t(),p(9,"input",3),n(10,"mat-error"),o(11),h(12,"validate"),t()(),n(13,"mat-form-field",2)(14,"mat-label",4),o(15,"\u05E1\u05D9\u05E1\u05DE\u05D4:"),t(),p(16,"input",5),n(17,"mat-icon",6),D("click",function(){return e.pwdOpen.set(!e.pwdOpen())}),o(18),t(),c(19,De,2,0,"mat-error"),c(20,he,2,0,"mat-error"),t(),n(21,"div",7)(22,"mat-icon"),o(23,"info"),t(),o(24),t(),n(25,"mat-checkbox",8),o(26," \u05D6\u05DB\u05D5\u05E8 \u05D0\u05D5\u05EA\u05D9 "),t()(),n(27,"mat-card-actions")(28,"button",9),c(29,Ee,2,0,"span")(30,ve,1,0,"shared-loading"),t()()()(),p(31,"error-msg",10),n(32,"a",11),o(33,"\u05D7\u05D6\u05E8\u05D4 \u05DC\u05E2\u05DE\u05D5\u05D3 \u05D4\u05DB\u05E0\u05D9\u05E1\u05D4"),t()),i&2&&(r(3),s("formGroup",e.f),r(4),g("",E(8,14,"login_username_caption"),": "),r(2),s("type",e.isMobile()?"number":"text"),r(2),y(E(12,16,e.c.identifier.errors)),r(5),_("is-invalid",e.c.pwd.dirty&&!e.c.pwd.valid),s("type",e.pwdOpen()?"text":"password"),r(2),g(" ",e.pwdOpen()?"visibility_off":"visibility"," "),r(),f(e.c.pwd.errors!=null&&e.c.pwd.errors.required?19:-1),r(),f(e.c.pwd.errors!=null&&e.c.pwd.errors.pattern?20:-1),r(4),g(" ",e.pwdSettings==null?null:e.pwdSettings.text," "),r(4),s("disabled",e.saving()),r(),f(e.saving()?30:29),r(2),s("err",e.error()))},dependencies:[A,Q,Y,j,G,K,W,z,H,P,ne,$,ie,te,ee,V,L,B,T,k,N,F,Z,X,ce,pe,U,R,ae,ue,le,me],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:1rem}mat-card[_ngcontent-%COMP%]{width:100%;max-width:320px}mat-card-title[_ngcontent-%COMP%], mat-card-content[_ngcontent-%COMP%]{display:flex;justify-content:center}mat-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;width:100%;gap:1rem}form[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{width:100%;min-width:280px}error-msg[_ngcontent-%COMP%]{display:block;text-align:center;width:100%;max-width:400px}.mat-mdc-card-actions[_ngcontent-%COMP%]{flex-direction:column;min-height:unset;padding:8px;gap:1rem}"]});let a=m;return a})();export{Ke as ActivateComponent};
